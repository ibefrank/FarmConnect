
<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="FruitFarmers.Pages.BuyerProfilePage"
             Title="My Profile">

    <Grid RowDefinitions="Auto,*,Auto">
        <!-- Header with profile image -->
        <StackLayout Grid.Row="0" Padding="20,30,20,0">
            <Frame HeightRequest="100" WidthRequest="100" 
                   CornerRadius="50" HorizontalOptions="Center"
                   Padding="0" IsClippedToBounds="True"
                   BorderColor="LightGray">
                <Image Source="profile_placeholder.png" Aspect="AspectFill"/>
            </Frame>
            <Label Text="{Binding UserName}" FontSize="20" FontAttributes="Bold" 
                   HorizontalOptions="Center" Margin="0,10,0,0"/>
            <Label Text="{Binding UserEmail}" TextColor="Gray" 
                   HorizontalOptions="Center" Margin="0,5,0,10"/>
        </StackLayout>

        <!-- Profile sections -->
        <ScrollView Grid.Row="1">
            <StackLayout Padding="20,0,20,0" Spacing="15">
                <!-- Personal Information Section -->
                <Frame Padding="15" CornerRadius="10" BorderColor="LightGray">
                    <StackLayout Spacing="15">
                        <Label Text="Personal Information" FontAttributes="Bold" FontSize="16"/>
                        
                        <StackLayout Orientation="Horizontal">
                            <Label Text="Name:" WidthRequest="100" VerticalOptions="Center"/>
                            <Entry Text="{Binding UserName}" Placeholder="Your name" HorizontalOptions="FillAndExpand"/>
                        </StackLayout>
                        
                        <StackLayout Orientation="Horizontal">
                            <Label Text="Email:" WidthRequest="100" VerticalOptions="Center"/>
                            <Entry Text="{Binding UserEmail}" Placeholder="Your email" HorizontalOptions="FillAndExpand"/>
                        </StackLayout>
                        
                        <StackLayout Orientation="Horizontal">
                            <Label Text="Phone:" WidthRequest="100" VerticalOptions="Center"/>
                            <Entry Text="{Binding UserPhone}" Placeholder="Your phone number" HorizontalOptions="FillAndExpand"/>
                        </StackLayout>
                        
                        <Button Text="Save Changes" Command="{Binding SaveProfileCommand}" 
                                BackgroundColor="#4CAF50" TextColor="White"
                                CornerRadius="5" Margin="0,10,0,0"/>
                    </StackLayout>
                </Frame>

                <!-- Delivery Addresses Section -->
                <Frame Padding="15" CornerRadius="10" BorderColor="LightGray">
                    <StackLayout Spacing="15">
                        <Label Text="Delivery Addresses" FontAttributes="Bold" FontSize="16"/>
                        
                        <CollectionView ItemsSource="{Binding DeliveryAddresses}" 
                                        EmptyView="No saved addresses">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="5" ColumnDefinitions="*, Auto">
                                        <StackLayout Grid.Column="0">
                                            <Label Text="{Binding AddressName}" FontAttributes="Bold"/>
                                            <Label Text="{Binding FullAddress}" FontSize="14" TextColor="Gray"/>
                                        </StackLayout>
                                        <Button Grid.Column="1" Text="Edit" 
                                                BackgroundColor="Transparent" TextColor="#4CAF50"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.EditAddressCommand}"
                                                CommandParameter="{Binding}"/>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                        
                        <Button Text="Add New Address" Command="{Binding AddAddressCommand}" 
                                BackgroundColor="Transparent" TextColor="#4CAF50"
                                BorderColor="#4CAF50" BorderWidth="1"
                                CornerRadius="5"/>
                    </StackLayout>
                </Frame>

                <!-- Payment Methods Section -->
                <Frame Padding="15" CornerRadius="10" BorderColor="LightGray">
                    <StackLayout Spacing="15">
                        <Label Text="Payment Methods" FontAttributes="Bold" FontSize="16"/>
                        
                        <CollectionView ItemsSource="{Binding PaymentMethods}" 
                                      EmptyView="No saved payment methods">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <Grid Padding="5" ColumnDefinitions="*, Auto">
                                        <StackLayout Grid.Column="0">
                                            <Label Text="{Binding MethodName}" FontAttributes="Bold"/>
                                            <Label Text="{Binding MethodDetails}" FontSize="14" TextColor="Gray"/>
                                        </StackLayout>
                                        <Button Grid.Column="1" Text="Edit"
                                                BackgroundColor="Transparent" TextColor="#4CAF50"
                                                Command="{Binding Source={RelativeSource AncestorType={x:Type ContentPage}}, Path=BindingContext.EditPaymentMethodCommand}"
                                                CommandParameter="{Binding}"/>
                                    </Grid>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                        
                        <Button Text="Add Payment Method" Command="{Binding AddPaymentMethodCommand}"
                                BackgroundColor="Transparent" TextColor="#4CAF50"
                                BorderColor="#4CAF50" BorderWidth="1"
                                CornerRadius="5"/>
                    </StackLayout>
                </Frame>

                <!-- Other Settings -->
                <Frame Padding="15" CornerRadius="10" BorderColor="LightGray">
                    <StackLayout Spacing="15">
                        <Label Text="Settings" FontAttributes="Bold" FontSize="16"/>
                        
                        <StackLayout Orientation="Horizontal">
                            <Label Text="Notifications" VerticalOptions="Center" HorizontalOptions="StartAndExpand"/>
                            <Switch IsToggled="{Binding NotificationsEnabled}" OnColor="#4CAF50"/>
                        </StackLayout>
                        
                        <Button Text="Change Password" Command="{Binding ChangePasswordCommand}"
                                BackgroundColor="Transparent" TextColor="#4CAF50"
                                BorderColor="#4CAF50" BorderWidth="1"
                                CornerRadius="5"/>
                                
                        <Button Text="Logout" Command="{Binding LogoutCommand}"
                                BackgroundColor="#FF5252" TextColor="White"
                                CornerRadius="5" Margin="0,10,0,0"/>
                    </StackLayout>
                </Frame>
            </StackLayout>
        </ScrollView>

        <!-- Bottom Navigation Bar -->
        <Grid Grid.Row="2" ColumnDefinitions="*,*,*,*,*" 
              BackgroundColor="White" Padding="0,10,0,10"
              ColumnSpacing="0">
            
            <StackLayout Grid.Column="0" HorizontalOptions="Center">
                <ImageButton Source="home_icon.png" HeightRequest="24" WidthRequest="24"
                           BackgroundColor="Transparent" Clicked="OnHomeTabClicked"/>
                <Label Text="Home" FontSize="12" HorizontalOptions="Center"/>
            </StackLayout>
            
            <StackLayout Grid.Column="1" HorizontalOptions="Center">
                <ImageButton Source="marketplace_icon.png" HeightRequest="24" WidthRequest="24"
                           BackgroundColor="Transparent" Clicked="OnMarketplaceTabClicked"/>
                <Label Text="Market" FontSize="12" HorizontalOptions="Center"/>
            </StackLayout>
            
            <StackLayout Grid.Column="2" HorizontalOptions="Center">
                <ImageButton Source="orders_icon.png" HeightRequest="24" WidthRequest="24"
                           BackgroundColor="Transparent" Clicked="OnOrdersTabClicked"/>
                <Label Text="Orders" FontSize="12" HorizontalOptions="Center"/>
            </StackLayout>
            
            <StackLayout Grid.Column="3" HorizontalOptions="Center">
                <ImageButton Source="messages_icon.png" HeightRequest="24" WidthRequest="24"
                           BackgroundColor="Transparent" Clicked="OnMessagesTabClicked"/>
                <Label Text="Messages" FontSize="12" HorizontalOptions="Center"/>
            </StackLayout>
            
            <StackLayout Grid.Column="4" HorizontalOptions="Center">
                <ImageButton Source="profile_icon.png" HeightRequest="24" WidthRequest="24"
                           BackgroundColor="Transparent"/>
                <Label Text="Profile" FontSize="12" HorizontalOptions="Center" TextColor="#4CAF50"/>
            </StackLayout>
        </Grid>
    </Grid>
</ContentPage>
